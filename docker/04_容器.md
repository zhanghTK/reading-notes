
## 运行容器


运行命令 docker run

### 指定容器启动时执行的命令：
1. Dockerfile 中 添加 CMD 命令
2. Dockerfile 中 添加 ENDPOINT 命令
3. 在 docker run 命令中指定，like：`docker run ubuntu pwd`

### 后期启动方式运行
docker ps：查看 Docker host 中当前运行的容器
docker ps -a：查看 Docker host 中所有状态的容器
docker run -d：以后台方式启动容器
docker run --name：为启动的容器指定名称

## 进入容器

attach & exec

### docker attach

用 attach 从没有正常过，网上对 attach 卡死的解释：[为什么执行 docker attach 卡住了?](https://www.lsproc.com/post/docker-faq#toc_16)
> 首先要明确的是 docker attach 不是一个用来进入容器的命令, 或者说他不是用来在容器内运行一个 bash(shell) 的命令, 它是用来连接到容器中运行中的进程, 也就是容器的 CMD, 容器内 PID=1 的那个进程, 如果这个进程没有 stdout/stderr 那么你将看不到任何输出, 如果它没有接收 stdin 你也无法发送指令给它. 这也就是为什么你运行一个 bash 的容器, 就可以 attach 进去执行命令, 而你运行一个 mysql server 的容器就无法操作的原因

### docker exec

docker exec -it ${CONTAINER} /bin/bash

-it：以交互模式打开 pseudo-TTY

### attach VS exec

attach 直接进入容器启动命令的终端，不会启动新的进程
exec 在容器中打开新的终端，并且可以启动新的进程

docker logs 查看启动命令输出，-f 参数

exec 使用场景更广，推荐

## 容器运行最佳实践

启动

- -d：以后台方式启动
- -it：启动时以交互模式进入，创建一个临时的工作环境，退出终端时同时容器停止

结束

当 CMD 或 ENTRYPOINT 或 docker run 命令执行的命令结束时，容器停止

## 容器操作

stop/start/restart

docker stop：停止容器，向 host 的容器进程发送一个 SIGTERM 信号

docker kill：快速停止容器，向 host 的容器进程发送一个 SIGKILL 信号

docker start：重新启动容器，会保留容器第一次启动时的所有参数

docker restart：依此执行 docker stop，docker start

--restart：在容器退出时应用的重启策略，默认不容器，可配置策略：
    --restart=always：无论容器银河原因退出就立即重启
    --restart=on-failure:3：启动进程退出代码非 0 ，则重启容器，最多重启3次